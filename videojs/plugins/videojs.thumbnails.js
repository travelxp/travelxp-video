/**
 * @license
 * Copyright (c) 2023 The Nuevodevel Team. All rights reserved.
 * Thumbnails Plugin for Video.js v8
 */
!function(){var e={align:"vertical",timeTooltip:!0,width:160,height:90,basePath:"",src:""},t=function(){var e,r,s,o,n;for(s in r=(e=Array.prototype.slice.call(arguments)).shift()||{},e)for(n in o=e[s])o.hasOwnProperty(n)&&("object"==typeof o[n]?r[n]=t(r[n],o[n]):r[n]=o[n]);return r},r=function(t){var r,s,o;if(-1===(s=t.indexOf("#")))return{src:t,w:0,h:0,x:0,y:0};if(r=t.substring(0,s),"xywh="!==(o=t.substring(s+1)).substring(0,5))return{src:e.basePath+r,w:0,h:0,x:0,y:0};var n=o.substring(5).split(",");return{src:e.basePath+r,w:parseInt(n[2]),h:parseInt(n[3]),x:parseInt(n[0]),y:parseInt(n[1])}};videojs.registerPlugin("thumbnails",function(s){var o,n,d,a,l,h,v,u,c,m,p,f,g;function w(e){const t=function(e){const t=e.split("."),r=t[0].split(":");return{milliseconds:parseInt(t[1],10)||0,seconds:parseInt(r.pop(),10)||0,minutes:parseInt(r.pop(),10)||0,hours:parseInt(r.pop(),10)||0}}(e);return parseInt(3600*t.hours+60*t.minutes+t.seconds+t.milliseconds/1e3,10)}function y(e){fetch(e).then(e=>e.text()).then(e=>{if(e.length>0){var t=function(e){var t=[];return e.split(/[\r\n][\r\n]/i).forEach(function(e){if(e.match(/([0-9]{2}:)?([0-9]{2}:)?[0-9]{2}(.[0-9]{3})?( ?--> ?)([0-9]{2}:)?([0-9]{2}:)?[0-9]{2}(.[0-9]{3})?[\r\n]{1}.*/gi)){const r=e.split(/[\r\n]/i),s=r[0].split(/ ?--> ?/i),o=s[0],n=s[1],i=r[1];t.push({startTime:w(o),endTime:w(n),text:i})}}),t}(e);t.length>0&&(g=t,j())}})}function j(){((o=document.createElement("div")).className="vjs-thumbnail-holder",tooltip=document.createElement("div"),tooltip.className="vjs-thumb-tooltip",(d=document.createElement("img")).className="vjs-thumb-image",o.appendChild(d),o.appendChild(tooltip),v.el().appendChild(o),a.shadowSlide)&&(a.el_.querySelector(".vjs-thumb-poster")||((h=document.createElement("div")).className="vjs-thumb-poster",l=document.createElement("canvas"),h.appendChild(l),a.el_.insertBefore(h,a.el_.querySelector(".vjs-poster"))));c=a.duration(),a.on("durationchange",function(e){c=a.duration()}),a.on("loadedmetadata",function(e){c=a.duration()});var e=v.el_.querySelector(".vjs-play-progress").querySelector(".vjs-time-tooltip");e&&videojs.dom.addClass(e,"vjs-abs-hidden"),mtp=v.el().querySelector(".vjs-mouse-display"),mtp&&(mtp.style.opacity=0);var t=!1,r=Object.defineProperty({},"passive",{get:function(){return t=!0,!0}});window.addEventListener("testPassive",null,r),window.removeEventListener("testPassive",null,r),u.addEventListener("mousemove",m),u.addEventListener("mouseleave",p),u.addEventListener("mousedown",E),u.addEventListener("touchstart",S,!!t&&{passive:!1})}function b(){o.classList.remove("vjs-thumb-show"),a.shadowSlide&&(h.removeAttribute("style"),l.width=0,l.height=0)}function x(){videojs.holderdown=!1,document.removeEventListener("mousemove",m),document.removeEventListener("mouseup",x),b()}function E(e){videojs.holderdown=!0,document.addEventListener("mousemove",m),document.addEventListener("mouseup",x),m(e)}function L(){u.removeEventListener("touchmove",m),u.removeEventListener("touchend",L),b()}function S(e){videojs.holderdown=!1,m(e),u.addEventListener("touchmove",m),u.addEventListener("touchend",L)}e.basePath="",n=t({},e,s),a=this,s&&(s.basePath&&(e.basePath=s.basePath),s.width&&s.height&&(e.width=s.width,e.height=s.height),s.src&&a.on("ready",function(){a.trigger("medialoaded",{xml:s.src})})),a.on("medialoaded",function(e,t){g=[],v=a.controlBar.progressControl,(u=a.el_.querySelector(".vjs-progress-holder")).removeEventListener("touchstart",S),u.removeEventListener("mousemove",m),u.removeEventListener("mouseleave",p),u.removeEventListener("mousedown",E),a.sprite=!1;var s=a.el_.querySelector(".vjs-thumb-tooltip");s&&s.parentNode.removeChild(s);var n=a.el_.querySelector(".vjs-thumb-image");n&&n.parentNode.removeChild(n);var i=a.el_.querySelector(".vjs-thumbnail-holder");if(i&&i.parentNode.removeChild(i),t&&t.xml)y(t.xml);else{v=a.controlBar.progressControl,u=a.el_.querySelector(".vjs-progress-holder");var d=a.textTracks().length;if(0===d)return void(o&&videojs.dom.addClass("div","vjs-hidden"));var l=!1;for(c=0;c<d;){if("metadata"===a.textTracks()[c].kind){if(void 0===(f=a.textTracks()[c]).src)return;if(f.src)return void y(f.src);if(f.mode="hidden",l=!0,(f=a.textTracks()[c]).mode="showing",null==f.cues)return void(f.mode="hidden");var h=f&&f.cues.length;break}c++}if(1!=l)return void(o&&videojs.dom.addClass("div","vjs-hidden"));if((h=(f=a.textTracks()[c])&&f.cues.length)<1)return;var c=0;for(a.sprite=!0;c<h;){var w=f.cues[c];ctt=r(w.text),c++}g=f&&f.cues,j()}}),p=function(e){!0!==videojs.holderdown&&o.classList.remove("vjs-thumb-show")},m=function(e){e.preventDefault(),c=a.duration();var t=v.el().querySelector(".vjs-progress-holder"),s=v.el().querySelector(".vjs-play-progress"),u=t.getBoundingClientRect(),m=null;e.pageX?m=e.pageX:e.changedTouches&&(m=e.changedTouches[0].pageX||e.touches[0].clientX);var p=m-u.left;if(0==p&&videojs.holderdown&&s.offsetWidth,p<0&&(p=0),p>t.offsetWidth&&(p=t.offsetWidth),n.timeTooltip){var f=p/t.offsetWidth*c,w=o.querySelector(".vjs-thumb-tooltip");w&&(w.innerHTML=function(e,t){e=e<0?0:e;let r=Math.floor(e%60),s=Math.floor(e/60%60),o=Math.floor(e/3600);const n=Math.floor(t/60%60),i=Math.floor(t/3600);return(isNaN(e)||e===1/0)&&(o=s=r="-"),(o=o>0||i>0?o+":":"")+(s=((o||n>=10)&&s<10?"0"+s:s)+":")+(r=r<10?"0"+r:r)}(f,c))}var y=g.length;i=0;for(var j=!1;i<y;){var b=g[i];if(b.startTime<=f&&b.endTime>=f){j=!0,vtt=r(b.text);break}i++}if(1==j){o.classList.remove("vjs-thumb-hidden"),d.src.indexOf(vtt.src)<0&&(d.src=vtt.src),0===vtt.w&&(vtt.w=n.width,d.style.width=vtt.w+"px"),0===vtt.h&&(vtt.h=n.height,d.style.height=vtt.h+"px"),o.style.width==vtt.w&&o.style.height==vtt.h||(o.style.width=vtt.w+"px",o.style.height=vtt.h+"px"),d.style.left=-vtt.x+"px",d.style.top=-vtt.y+"px";var x=vtt.w,E=x/2,L=v.el().offsetWidth,S=a.el_.querySelector(".vjs-progress-holder").offsetLeft,q=E-S;if(p+E+S>L?p=L-x:p<q?p=0:p-=q,o.style.left=parseInt(p)+"px",o.classList.add("vjs-thumb-show"),videojs.holderdown&&a.shadowSlide){a.el_.querySelector(".vjs-thumb-poster")||((h=document.createElement("div")).className="vjs-thumb-poster",l=document.createElement("canvas"),h.appendChild(l),a.el_.insertBefore(h,a.el_.querySelector(".vjs-poster")));var C=l.getContext("2d");l.width=a.el_.offsetWidth,l.height=a.el_.offsetHeight,h.style.width=l.width+"px",h.style.height=l.height+"px",C.clearRect(0,0,l.width,l.height),C.drawImage(d,vtt.x,vtt.y,vtt.w,vtt.h,0,0,l.width,l.height)}}else o.classList.add("vjs-thumb-hidden")}})}();
